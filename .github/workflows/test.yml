name: "Tests"

on: 
  pull_request:
  workflow_dispatch:


jobs: 
    test:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v3
              with:
                fetch-depth: 2  
            - name: Setup PHP Action
              uses: shivammathur/setup-php@2.25.5
              with: 
                php-version: '8.0'
              env:
                TEST_RAYGUN_KEY: ${{ secrets.TEST_RAYGUN_KEY }}
                TEST_APPSIGNAL_KEY: ${{ secrets.TEST_APPSIGNAL_KEY }}
                TEST_SENTRY_DSN: ${{ secrets.TEST_SENTRY_DSN }}
            - name: Install dependencies
              run: composer install --ignore-platform-reqs
            - name: Run Tests
              run: vendor/bin/phpunit --configuration phpunit.xml tests
              